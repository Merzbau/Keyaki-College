EXTEND_BOTTOM DOGHMA 0
	IF ~Global("kzlizuo","GLOBAL",1)~ THEN REPLY @101 GOTO M0
	END

CHAIN DOGHMA M0
	@102
	END
	IF ~~ THEN REPLY @103 GOTO M1

CHAIN DOGHMA M1
	@104
	END
	IF ~~ THEN REPLY @105 GOTO M2

CHAIN DOGHMA M2
	@106
	END
	IF ~~ THEN REPLY @107 GOTO M3

CHAIN DOGHMA M3
	@108
	END
	IF ~~ THEN
EXIT

BEGIN KZLZDLG

CHAIN IF~Global("kzlizuo","GLOBAL",0)~THEN KZLZDLG LZ0
	@0
	END
	IF ~~ THEN REPLY @1 GOTO LZ1	
	IF ~~ THEN REPLY @2 GOTO LZ1	
	IF ~~ THEN REPLY @3 GOTO LZ1	

CHAIN KZLZDLG LZ1
	@4
	=@5
	END
	IF ~~ THEN REPLY @6 GOTO LZ2		
	IF ~~ THEN REPLY @7 GOTO LZ2	
	IF ~~ THEN REPLY @8 GOTO LZ2.1

CHAIN KZLZDLG LZ2.1
	@9
	== YOSHJ IF ~InParty("Yoshimo") InMyArea("Yoshimo") !StateCheck("Yoshimo",CD_STATE_NOTVALID)~ THEN @198
	END
	IF ~~ THEN REPLY @6 GOTO LZ2	
	IF ~~ THEN REPLY @7 GOTO LZ2

CHAIN KZLZDLG LZ2
	@10
	END
	IF ~~ THEN REPLY @11 GOTO LZ3		
	IF ~~ THEN REPLY @12 GOTO LZ3	
	IF ~~ THEN REPLY @13 GOTO LZ3	

CHAIN KZLZDLG LZ3
	@14
	== EDWINJ IF ~InParty("Edwin") InMyArea("Edwin") !StateCheck("Edwin",CD_STATE_NOTVALID)~ THEN @199
	== KZLZDLG @15
	END
	IF ~~ THEN REPLY @16 GOTO LZ4			
	IF ~~ THEN REPLY @17 GOTO LZ4		
	IF ~~ THEN REPLY @18 GOTO LZ4		

CHAIN KZLZDLG LZ4
	@19
	=@20
	END
	IF ~~ THEN REPLY @21 GOTO LZ5.1	
	IF ~~ THEN REPLY @22 GOTO LZ5.2		
	IF ~~ THEN REPLY @23 GOTO LZ5.3	

CHAIN KZLZDLG LZ5.1
	@24
	== AERIEJ IF ~InParty("Aerie") InMyArea("Aerie") !StateCheck("Aerie",CD_STATE_NOTVALID)~ THEN @200
	== KZLZDLG @25
	END
	IF ~~ THEN REPLY @26 GOTO LZ6.1

CHAIN KZLZDLG LZ5.2
	@28
	== KORGANJ IF ~InParty("Korgan") InMyArea("Korgan") !StateCheck("Korgan",CD_STATE_NOTVALID)~ THEN @201
	== KZLZDLG @25
	END
	IF ~~ THEN REPLY @26 GOTO LZ6.1
	
CHAIN KZLZDLG LZ5.3
	@29
	== HAERDAJ IF ~InParty("Haerdalis") InMyArea("Haerdalis") !StateCheck("Haerdalis",CD_STATE_NOTVALID)~ THEN @202
	== KZLZDLG @25
	END
	IF ~~ THEN REPLY @26 GOTO LZ6.1
	
CHAIN KZLZDLG LZ6.1
	@30
	END	
	IF ~~ THEN REPLY @31 GOTO LZ7
	IF ~~ THEN REPLY @32 GOTO LZ7

CHAIN KZLZDLG LZ7
	@34
	END
	IF ~~ THEN REPLY @35 GOTO LZ8.1 	
	IF ~~ THEN REPLY @36 GOTO LZ8.2 	
	IF ~~ THEN REPLY @37 GOTO LZ8.3 	

CHAIN KZLZDLG LZ8.1
	@38
	== MINSCJ IF ~InParty("Minsc") InMyArea("Minsc") !StateCheck("Minsc",CD_STATE_NOTVALID)~ THEN @203
	END
	IF ~~ THEN REPLY @39 GOTO LZ9

CHAIN KZLZDLG LZ8.2
	@40
	== JAHEIRAJ IF ~InParty("Jaheira") InMyArea("Jaheira") !StateCheck("Jaheira",CD_STATE_NOTVALID)~ THEN @204
	END
	IF ~~ THEN REPLY @39 GOTO LZ9

CHAIN KZLZDLG LZ8.3
	@41
	== VICONIJ IF ~InParty("Viconia") InMyArea("Viconia") !StateCheck("Viconia",CD_STATE_NOTVALID)~ THEN @205
	END
	IF ~~ THEN REPLY @39 GOTO LZ9

CHAIN KZLZDLG LZ9
	@42
	END	
	IF ~~ THEN REPLY @44 GOTO LZ10.1
	IF ~~ THEN REPLY @45 GOTO LZ10.2

CHAIN KZLZDLG LZ10.1
	@46
	END
	IF ~~ THEN REPLY @47 GOTO LZ11

CHAIN KZLZDLG LZ10.2
	@48
	== ANOMENJ IF ~InParty("Anomen") InMyArea("Anomen") !StateCheck("Anomen",CD_STATE_NOTVALID)~ THEN @206
	END
	IF ~~ THEN REPLY @47 GOTO LZ11	

CHAIN KZLZDLG LZ11
	@49
	=@50
	END
	IF ~~ THEN REPLY @51 GOTO LZ12	
	IF ~~ THEN REPLY @52 GOTO LZ12	
	IF ~~ THEN REPLY @53 GOTO LZ12	

CHAIN KZLZDLG LZ12
	@54
	END
	IF ~~ THEN REPLY @55 GOTO LZ13.1	
	IF ~~ THEN REPLY @56 GOTO LZ13.2	
	IF ~~ THEN REPLY @57 GOTO LZ13.3		

CHAIN KZLZDLG LZ13.1
	@58	
	END
	IF ~~ THEN REPLY @59 GOTO LZ14	 	

CHAIN KZLZDLG LZ13.2
	@60	
	END	
	IF ~~ THEN REPLY @59 GOTO LZ14	 	

CHAIN KZLZDLG LZ13.3	
	@61
	END	
	IF ~~ THEN REPLY @62 GOTO LZ13.4	 	
	IF ~~ THEN REPLY @63 GOTO LZ13.4	

CHAIN KZLZDLG LZ13.4
	@64
	== KZLZDLG @65
	== CERNDJ IF ~InParty("Cernd") InMyArea("Cernd") !StateCheck("Cernd",CD_STATE_NOTVALID)~ THEN @207
	END
	IF ~~ THEN REPLY @59 GOTO LZ14	 	

CHAIN KZLZDLG LZ14
	@66
	=@67
	END	
	IF ~~ THEN REPLY @68 GOTO LZ15	 		
	IF ~~ THEN REPLY @69 GOTO LZ15	
	IF ~~ THEN REPLY @70 GOTO LZ15			

CHAIN KZLZDLG LZ15
	@72
	== NALIAJ IF ~InParty("Nalia") InMyArea("Nalia") !StateCheck("Nalia",CD_STATE_NOTVALID)~ THEN @208
	== KZLZDLG @73
	END
	IF ~~ THEN 	
	DO ~SetGlobal("kzlizuo","GLOBAL",1)
	AddJournalEntry(@10010,QUEST)~
EXIT

CHAIN IF~Global("kzlizuo","GLOBAL",1)
	!Global("kzfuyuan","GLOBAL",2)
	!Global("kzfuyuan","GLOBAL",3)~THEN KZLZDLG DB0	
	@74
	END
	IF ~Global("kzfuyuan","GLOBAL",0)~ THEN REPLY @75 GOTO DB1
	IF ~PartyHasItem("RESTORE")
	Global("kzfuyuan","GLOBAL",1)
	Global("kzjuanzhou","GLOBAL",0)~ THEN REPLY @110 GOTO DB2
	IF ~~ THEN REPLY @156 GOTO DB3
	IF ~~ THEN REPLY @188 GOTO DB6 	
	IF ~~ THEN REPLY @164 GOTO DB4	
	IF ~~ THEN REPLY @174 GOTO DB5			
	IF ~~ THEN REPLY @186 EXIT

CHAIN KZLZDLG DB1
	@76
	END
	IF ~~ THEN REPLY @78 GOTO DB1.2

CHAIN KZLZDLG DB1.2
	@79
	END
	IF ~~ THEN REPLY @80 GOTO DB1.3	

CHAIN KZLZDLG DB1.3	
	@82
	=@83
	END
	IF ~~ THEN REPLY @84 GOTO DB1.4		
	IF ~~ THEN REPLY @85 GOTO DB1.4	

CHAIN KZLZDLG DB1.4
	@89
	== JANJ IF ~InParty("Jan") InMyArea("Jan") !StateCheck("Jan",CD_STATE_NOTVALID)~ THEN @209
	END
	IF ~~ THEN REPLY @91 GOTO DB1.5	
	IF ~~ THEN REPLY @92 GOTO DB1.51

CHAIN KZLZDLG DB1.5	
	@93
	END
	IF ~~ THEN REPLY @94 GOTO DB1.6	
	IF ~~ THEN REPLY @95 GOTO DB1.6

CHAIN KZLZDLG DB1.51
	@96
	END
	IF ~~ THEN REPLY @94 GOTO DB1.6	
	IF ~~ THEN REPLY @95 GOTO DB1.6

CHAIN KZLZDLG DB1.6	
	@97
	END	
	IF ~~ THEN REPLY @98 GOTO DB1.7
	IF ~~ THEN REPLY @99 GOTO DB1.7	

CHAIN KZLZDLG DB1.7	
	@100
	END
	IF ~~ THEN 	
	DO ~SetGlobal("kzfuyuan","GLOBAL",1)
	AddJournalEntry(@10011,QUEST)~
EXIT	

CHAIN KZLZDLG DB2
	@111
	END
	IF ~~ THEN REPLY @112 GOTO DB2.1

CHAIN KZLZDLG DB2.1
	@122
	=@123
	END
	IF ~~ THEN REPLY @124 GOTO DB2.5 
	IF ~~ THEN REPLY @125 GOTO DB2.5

CHAIN KZLZDLG DB2.5
	@126
	END
	IF ~~ THEN REPLY @127 GOTO DB2.6 

CHAIN KZLZDLG DB2.6
	@128
	END	
	IF ~~ THEN
	DO ~SetGlobal("kzjuanzhou","GLOBAL",1)~
EXIT
	
CHAIN KZLZDLG DB3	
	@157
	END
	IF ~~ THEN REPLY @158 GOTO DB3.1	

CHAIN KZLZDLG DB3.1
	@159
	END
	IF ~~ THEN REPLY @161 GOTO DB3.2		

CHAIN KZLZDLG DB3.2
	@162
	END
	IF ~~ THEN REPLY @163 GOTO DB3.3

CHAIN KZLZDLG DB3.3
	@187
	== MAZZYJ IF ~InParty("Mazzy") InMyArea("Mazzy") !StateCheck("Mazzy",CD_STATE_NOTVALID)~ THEN @210
	END
	IF ~~ THEN 
EXIT

CHAIN KZLZDLG DB4
	@165
	END
	IF ~~ THEN REPLY @166 GOTO DB4.1	
	IF ~~ THEN REPLY @167 GOTO DB4.2	
	IF ~~ THEN REPLY @168 GOTO DB4.3

CHAIN KZLZDLG DB4.1
	@169
	END
	IF ~~ THEN REPLY @170 GOTO DB4.4

CHAIN KZLZDLG DB4.2
	@171
	END
	IF ~~ THEN REPLY @170 GOTO DB4.4

CHAIN KZLZDLG DB4.3	
	@172
	END	
	IF ~~ THEN REPLY @170 GOTO DB4.4

CHAIN KZLZDLG DB4.4
	@173
	END	
	IF ~~ THEN 	
EXIT

CHAIN KZLZDLG DB5
	@175
	END	
	IF ~~ THEN REPLY @177 GOTO DB5.1 
	IF ~~ THEN REPLY @178 GOTO DB5.2  

CHAIN KZLZDLG DB5.1
	@179
	END
	IF ~~ THEN REPLY @178 GOTO DB5.2  

CHAIN KZLZDLG DB5.2	
	@180
	END		
	IF ~~ THEN REPLY @182 GOTO DB5.3	
	IF ~~ THEN REPLY @183 GOTO DB5.3	

CHAIN KZLZDLG DB5.3
	@184
	=@185
	END
	IF ~~ THEN 	
EXIT
	
CHAIN KZLZDLG DB6	
	@189
	END	
	IF ~~ THEN REPLY @190 GOTO DB6.1

CHAIN KZLZDLG DB6.1
	@191
	END
	IF ~~ THEN REPLY @192 GOTO DB6.2	

CHAIN KZLZDLG DB6.2
	@193
	== KELDORJ IF ~InParty("Keldorn") InMyArea("Keldorn") !StateCheck("Keldorn",CD_STATE_NOTVALID)~ THEN @211
	END
	IF ~Gender(Player1,MALE)~ THEN REPLY @194 GOTO DB6.3
	IF ~Gender(Player1,FEMALE)~ THEN REPLY @194 GOTO DB6.4	

CHAIN KZLZDLG DB6.3
	@196
	END
	IF ~~ THEN
EXIT
	
CHAIN KZLZDLG DB6.4
	@197
	END	
	IF ~~ THEN
EXIT
	
CHAIN IF~Global("kzfuyuan","GLOBAL",2)~THEN KZLZDLG FY0	
	@109
	=@129
	END	
	IF ~~ THEN REPLY @130 GOTO FY1	
	IF ~~ THEN REPLY @131 GOTO FY1	
	IF ~Global("kzjuanzhou","GLOBAL",1)~ THEN REPLY @132 GOTO FY1				

CHAIN KZLZDLG FY1
	@133
	END
	IF ~~ THEN REPLY @134 GOTO FY2		
	IF ~~ THEN REPLY @135 GOTO FY2		

CHAIN KZLZDLG FY2
	@136
	END
	IF ~~ THEN REPLY @137
	DO ~ClearAllActions()
	StartCutSceneMode()
	StartCutScene("KZCUTFY")~
EXIT

CHAIN IF~Global("kzfuyuan","GLOBAL",3)
	Global("kzlizuo","GLOBAL",1)~THEN KZLZDLG FY3		
	@138
	END
	IF ~~ THEN REPLY @139 GOTO FY4	
	IF ~~ THEN REPLY @140 GOTO FY4		

CHAIN KZLZDLG FY4	
	@141
	END	
	IF ~~ THEN REPLY @142 GOTO FY5	

CHAIN KZLZDLG FY5
	@143
	=@144
	=@145
	END
	IF ~~ THEN REPLY @146 GOTO FY5.1		
	IF ~~ THEN REPLY @147 GOTO FY5.2		

CHAIN KZLZDLG FY5.1
	@148
	END
	IF ~~ THEN REPLY @149 GOTO FY5.11

CHAIN KZLZDLG FY5.11
	@150
	END
	IF ~~ THEN REPLY @151 GOTO FY6

CHAIN KZLZDLG FY5.2
	@150 
	END
	IF ~~ THEN REPLY @152 GOTO FY5.21

CHAIN KZLZDLG FY5.21
	@148
	END
	IF ~~ THEN REPLY @151 GOTO FY6 

CHAIN KZLZDLG FY6
	@153
	=@154
	=@155
	END
	IF ~~ THEN 
	DO ~SetGlobal("kzlizuo","GLOBAL",2)
	EraseJournalEntry(@10010)
	EraseJournalEntry(@10011)	
	AddJournalEntry(@10012,QUEST_DONE)
	AddExperienceParty(3000)
	EscapeArea()~
EXIT
	
CHAIN IF~Global("kzlizuo","GLOBAL",3)~THEN KZLZDLG SNLZ0
	@212
	END
	IF ~~ THEN REPLY @215 GOTO SNLZ3	
	
CHAIN KZLZDLG SNLZ3	
	@220
	END
	IF ~~ THEN REPLY @221 GOTO SNLZ4	
	
CHAIN KZLZDLG SNLZ4	
	@222
	END
	IF ~~ THEN REPLY @223 GOTO SNLZ5	
	
CHAIN KZLZDLG SNLZ5	
	@224
	== KZJJDLG @225
	== KZLZDLG @226
	== KZJJDLG @227
	== KZSWDLG @228
	== KZJJDLG @229	
	== KZLZDLG @230	
	== KZSWDLG @231	
	== KZLZDLG @232	
	END
	IF ~~ THEN REPLY @233 GOTO SNLZ6	
	
CHAIN KZLZDLG SNLZ6
	@234
	END	
	IF ~~ THEN REPLY @235 GOTO SNLZ7		
	
CHAIN KZLZDLG SNLZ7	
	@236
	END	
	IF ~~ THEN REPLY @237 GOTO SNLZ8		
	
CHAIN KZLZDLG SNLZ8
	@239
	== KZPSDLG @240
	END
	IF ~~ THEN 
EXIT	
	
CHAIN IF~Global("kzlizuo","GLOBAL",4)~THEN KZLZDLG SNLZ9
	@241
	END
	IF ~Global("kzlizuoDC","GLOBAL",0)~ THEN REPLY @242 GOTO SNLZ10		
	IF ~~ THEN REPLY @243 GOTO SNLZ11	
	
CHAIN KZLZDLG SNLZ10
	@245
	=@246
	=@247
	END
	IF ~~ THEN REPLY @249 GOTO SNLZ10.1		
	
CHAIN KZLZDLG SNLZ10.1
	@250
	END
	IF ~~ THEN 
	DO~SetGlobal("kzlizuoDC","GLOBAL",1)~	
EXIT

CHAIN KZLZDLG SNLZ11	
	@251
	=@252
	END
	IF ~~ THEN REPLY @253 GOTO SNLZ11.1		
	IF ~~ THEN REPLY @254 GOTO SNLZ11.1		
	
CHAIN KZLZDLG SNLZ11.1
	@255
	=@256
	END
	IF ~~ THEN	
EXIT	
	
CHAIN IF~Global("kzlizuo","GLOBAL",5)~THEN KZLZDLG TRLZ1	
	@267
	END
	IF ~~ THEN REPLY @268 GOTO TRLZ2
	
CHAIN KZLZDLG TRLZ2
	@269
	END
	IF ~~ THEN REPLY @270 GOTO TRLZ3	
	
CHAIN KZLZDLG TRLZ3	
	@271
	=@272
	END	
	IF ~~ THEN 
EXIT	
	
CHAIN IF~Global("kzlizuo","GLOBAL",6)~THEN KZLZDLG TRLZ4		
	@273
	END
	IF ~~ THEN REPLY @274 GOTO TRLZ5	
	IF ~Global("kzshenqu","GLOBAL",1)
	PartyHasItem("kzdanga")~ THEN REPLY @275 GOTO TRLZ6	
	
CHAIN KZLZDLG TRLZ5	
	@276
	END
	IF ~~ THEN 
EXIT

CHAIN KZLZDLG TRLZ6	
	@277
	END
	IF ~~ THEN REPLY @278 GOTO TRLZ6.1
	
CHAIN KZLZDLG TRLZ6.1
	@262
	== KZWFDLG @263
	== KZLZDLG @264
	== KZWFDLG @265
	== KZLZDLG @266
	END
	IF ~~ THEN 
	DO~SetGlobal("kzshenqu","GLOBAL",2)~	
EXIT	
	
CHAIN IF~Global("kzlizuo","GLOBAL",7)~THEN KZLZDLG TRLZ7	
	@279
	END
	IF ~~ THEN REPLY @280 GOTO TRLZ7.1
	
CHAIN KZLZDLG TRLZ7.1	
	@281
	=@282
	END
	IF ~~ THEN 
EXIT

CHAIN IF~Global("kzlizuo","GLOBAL",8)~THEN KZLZDLG TRLZ8
	@283
	END
	IF ~~ THEN REPLY @284 GOTO TRLZ8.1

CHAIN KZLZDLG TRLZ8.1
	@285
	END
	IF ~~ THEN 
EXIT

CHAIN IF~Global("kzlizuo","GLOBAL",10)~THEN KZLZDLG TRLZ9
	@286
	END
	IF ~~ THEN 
EXIT

CHAIN IF~Global("kzlizuo","GLOBAL",11)~THEN KZLZDLG TRLZ10
	@287
	== KZCBDLG @288
	END
	IF ~~ THEN REPLY @289 EXTERN KZCBDLG TRLZ11
	
CHAIN KZCBDLG TRLZ11
	@290
	== KZSWDLG @291
	== KZJJDLG @292
	== KZPSDLG @293
	END
	IF ~~ THEN REPLY @294 DO ~PlaySound("dsost5")~ EXTERN KZCBDLG TRLZ12
	
CHAIN KZCBDLG TRLZ12
	@248
	== KZCBDLG @295	
	== KZCBDLG @296
	== KZCBDLG @297
	== KZLZDLG @298
	== KZCBDLG @299
	== KZCBDLG @300
	== KZCBDLG @301
	== KZCBDLG @261
	== KZLZDLG @260
	== KZLZDLG @259
	== KZLZDLG @258
	END
	IF ~~ THEN REPLY @257 EXTERN KZCBDLG TRLZ13	 
	
CHAIN KZCBDLG TRLZ13
	@244
	== KZLZDLG @238
	== KZJJDLG @219
	== KZSWDLG @218
	== KZCBDLG @217
	== KZLJDLG @216
	== KZLZDLG @214
	== KZCBDLG @213
	END
	IF ~~ THEN REPLY @195 EXTERN KZPSDLG TRLZ14	 	
	IF ~~ THEN REPLY @117 EXTERN KZPSDLG TRLZ14
	
CHAIN KZPSDLG TRLZ14	
	@181
	== KZSWDLG @176
	== KZJJDLG @160
	== KZSWDLG @121
	== KZLJDLG @120
	== KZPSDLG @119
	== KZPSDLG @118
	END
	IF ~~ THEN REPLY @116 EXTERN KZPSDLG TRLZ15		
	IF ~~ THEN REPLY @115 EXTERN KZPSDLG TRLZ15	
	
CHAIN KZPSDLG TRLZ15	
	@114
	== KZJJDLG @113
	== KZCBDLG @86
	== KZSWDLG @90
	== KZPSDLG @88
	== KZPSDLG @87
	END
	IF ~~ THEN 		
	DO ~SetGlobal("kzlizuo","GLOBAL",12)
	SetGlobal("kzlijia","GLOBAL",12)
	SetGlobal("kzpingshou","GLOBAL",12)
	SetGlobal("kzchangbin","GLOBAL",12)
	SetGlobal("kzshouwu","GLOBAL",12)
	SetGlobal("kzjianjing","GLOBAL",12)	
	SetGlobal("kzaoko","GLOBAL",12)	
	AddJournalEntry(@10028,QUEST)~	
EXIT
		
CHAIN IF~Global("kzlizuo","GLOBAL",12)~THEN KZLZDLG TRLZ16	
	@81
	== KZCBDLG @77
	== KZLZDLG @71
	== KZCBDLG @43
	== KZLZDLG @33
	== KZCBDLG @27
	END
	IF ~~ THEN 	
EXIT	
	
	